# ==> Глобальні налаштування збірки
# Ці налаштування застосовуються до всіх розгортань.
[build]
  # Команда для збірки вашого сайту
  command = "npm run build"
  
  # Директорія для публікації, створена командою збірки
  publish = "dist"
  
  # Директорія, де знаходяться ваші безсерверні функції
  functions = "netlify/functions"

# ==> Перенаправлення та переписування шляхів
# Правила обробляються зверху вниз.

# Проксі для API-запитів до функцій Netlify.
# Це робить запити до /api/* доступними на клієнтській стороні,
# направляючи їх до ваших серверних функцій без проблем з CORS.
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200 # Статус 200 означає переписування, а не перенаправлення

# Правило для Single-Page Application (SPA).
# Це правило має бути останнім у файлі. Воно гарантує, що будь-який запит,
# який не відповідає файлу на диску або попередньому правилу,
# буде перенаправлено на ваш головний файл index.html. Це критично для клієнтської маршрутизації.
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# ==> Кастомні заголовки
# Ці заголовки покращують безпеку та вирішують специфічні крос-доменні проблеми.
[[headers]]
  # Застосувати ці заголовки до всіх сторінок вашого сайту.
  for = "/*"
  [headers.values]
    # Це ключове виправлення для помилки "Cross-Origin-Opener-Policy".
    # Воно дозволяє спливаючим вікнам, відкритим вашим сайтом (наприклад, Google Sign-In),
    # безпечно обмінюватися даними з вашим головним вікном додатку.
    Cross-Origin-Opener-Policy = "same-origin-allow-popups"
    Cross-Origin-Embedder-Policy = "require-corp"
    Referrer-Policy = "strict-origin-when-cross-origin"
    X-Content-Type-Options = "nosniff"
    X-Frame-Options = "DENY"
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"
